---
import Course from '@layouts/Course.astro';
import { getCollection } from 'astro:content';
import { capitalizeString, formatWeekString, SYMBOLS } from 'src/global';
const currentDate = new Date();
const weeklyResources = await getCollection('weekly-resources', ({ id }) => {
  if (!id.startsWith('computer-science')) return false;
  if (import.meta.env.DEV) return true;
  const date = new Date(id.slice(-10));
  if (date.getFullYear() > currentDate.getFullYear()) return false;
  if (date.getMonth() > currentDate.getMonth()) return false;
  if (date.getDate() > currentDate.getDate()) return false;
  return true;
});
---

<Course course="Computer Science" semester="Fall">
  <blockquote>
    <p>There are only two hard things in Computer Science: cache invalidation and naming things.</p>
    <p><cite>Phil Karlton</cite></p>
  </blockquote>
  <h2>Course Resources</h2>
  <p>These resources will be used throughout the entirity of the course.</p>
  <table>
    <tbody>
      <tr>
        <td>
          <a href="/2024/fall/computer-science/syllabus">Course Syllabus</a>
        </td>
        <td>
          Includes an overview of the topics covered, grading criteria, and participation expectations.
        </td>
      </tr>
      <tr>
        <td>
          <a href="https://onecompiler.com/studio" target="_blank">OneCompiler Studio</a>
        </td>
        <td>
          Online <abbr title="integrated development environment">IDE</abbr> used for coding; can be accessed from any computer via Google account or username/password.
        </td>
      </tr>
      <tr>
        <td>
          <a href="mailto:rylanschubkegel@gmail.com" target="_blank">rylanschubkegel@gmail.com</a>
          <br><a href="tel:+13608401401">3600-840-1401</a>
        </td>
        <td>
          Instructor contact information.
        </td>
      </tr>
    </tbody>
  </table>
  <h2>Weekly Resources</h2>
  <details>
    <summary>Legend</summary>
    <ul class="emoji">
      {
        Object.entries(SYMBOLS).map(([title, emoji]) => (
          <li>{emoji} {capitalizeString(title)}</li>
        ))
      }
    </ul>
  </details>
  <table>
    <thead>
      <tr>
        <th>Dates</th>
        <th>Topic(s)</th>
        <th>Resources</th>
      </tr>
    </thead>
    <tbody>
      {
        weeklyResources.map(({ id, data }) => (
          <tr>
            <td>{formatWeekString(id.slice(-10))}</td>
            <td>
              <ul>
                {
                  data.topics.map(topic => (
                    <li>{topic}</li>
                  ))
                }
              </ul>
            </td>
            <td>
              <ul class="emoji">
                {
                  data.resources.map(resource => (
                    <li>
                      {SYMBOLS[resource.type]} <a href={resource.href} target="_blank">{resource.title}</a>
                    </li>
                  ))
                }
              </ul>
            </td>
          </tr>
        ))
      }
    </tbody>
  </table>
</Course>
